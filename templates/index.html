{% extends "base.html" %}
{% block title %}Predict{% endblock %}

{% block content %}
<div class="row g-4 align-items-stretch">
  <div class="col-lg-5">
    <div class="card soft-card h-100">
      <div class="card-body p-4">
        <h2 class="h4 fw-bold mb-2"><i class="bi bi-magic me-2"></i>Legendary Prediction</h2>
        <p class="text-muted mb-4">Fill Pokémon features and predict if it’s Legendary.</p>

        <form method="POST" action="{{ url_for('predict') }}">
          <div class="row g-3">
            <div class="col-6">
              <label class="form-label">Generation</label>
              <input name="Generation" type="number" min="1" max="9" value="1" class="form-control">
            </div>
            <div class="col-6">
              <label class="form-label">Catch Rate</label>
              <input name="Catch_Rate" type="number" step="0.1" value="45" class="form-control">
            </div>

            <div class="col-6"><label class="form-label">Total</label><input name="Total" type="number" value="450" class="form-control"></div>
            <div class="col-6"><label class="form-label">HP</label><input name="HP" type="number" value="60" class="form-control"></div>
            <div class="col-6"><label class="form-label">Attack</label><input name="Attack" type="number" value="70" class="form-control"></div>
            <div class="col-6"><label class="form-label">Defense</label><input name="Defense" type="number" value="60" class="form-control"></div>
            <div class="col-6"><label class="form-label">Sp_Atk</label><input name="Sp_Atk" type="number" value="70" class="form-control"></div>
            <div class="col-6"><label class="form-label">Sp_Def</label><input name="Sp_Def" type="number" value="60" class="form-control"></div>
            <div class="col-6"><label class="form-label">Speed</label><input name="Speed" type="number" value="70" class="form-control"></div>

            <div class="col-6">
              <label class="form-label">Height (m)</label>
              <input name="Height_m" type="number" step="0.01" value="1.0" class="form-control">
            </div>
            <div class="col-6">
              <label class="form-label">Weight (kg)</label>
              <input name="Weight_kg" type="number" step="0.1" value="10" class="form-control">
            </div>

            <div class="col-6">
              <label class="form-label">Pr_Male (0..1)</label>
              <input name="Pr_Male" type="number" step="0.01" value="0.5" class="form-control">
            </div>

            <div class="col-6">
              <label class="form-label">Body_Style_new</label>
              <input name="Body_Style_new" type="number" step="0.01" value="1" class="form-control">
              <div class="form-text">If unknown, keep default.</div>
            </div>

            <div class="col-12">
              <label class="form-label">Color</label>
              <select class="form-select" name="color">
                <option value="">-- select --</option>
                {% for c in color_features %}
                  <option value="{{ c }}">{{ c }}</option>
                {% endfor %}
              </select>
            </div>

            <div class="col-12">
              <div class="d-flex gap-4 flex-wrap">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" name="hasGender" id="hasGender" checked>
                  <label class="form-check-label" for="hasGender">hasGender</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" name="hasMegaEvolution" id="hasMegaEvolution">
                  <label class="form-check-label" for="hasMegaEvolution">hasMegaEvolution</label>
                </div>
              </div>
            </div>

            <div class="col-12">
              <label class="form-label">Types (select one or more)</label>
              <div class="type-grid">
                {% for t in type_features %}
                  <label class="type-pill">
                    <input type="checkbox" name="types" value="{{ t }}">
                    <span>{{ t }}</span>
                  </label>
                {% endfor %}
              </div>
            </div>

            <div class="col-12 d-grid">
              <button class="btn btn-primary btn-lg">
                <i class="bi bi-cpu me-2"></i>Predict Legendary
              </button>
            </div>
          </div>
        </form>

      </div>
    </div>
  </div>

  <div class="col-lg-7">
    <div class="card soft-card h-100">
      <div class="card-body p-4">
        <h2 class="h4 fw-bold mb-2"><i class="bi bi-bar-chart me-2"></i>Quick Dashboard</h2>
        <p class="text-muted mb-4">
          See which features matter most for your model.
        </p>

        <div class="row g-3">
          <div class="col-md-6">
            <div class="stat-card p-4 rounded-4 border bg-body">
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <div class="text-muted small">Model</div>
                  <div class="fw-bold">RandomForestClassifier</div>
                </div>
                <i class="bi bi-diagram-3 fs-2 text-primary"></i>
              </div>
              <div class="mt-3 small text-muted">
                Your pickle model is loaded at startup.
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="stat-card p-4 rounded-4 border bg-body">
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <div class="text-muted small">Target</div>
                  <div class="fw-bold">isLegendary (True/False)</div>
                </div>
                <i class="bi bi-stars fs-2 text-warning"></i>
              </div>
              <div class="mt-3 small text-muted">
                Result shows probability + final class.
              </div>
            </div>
          </div>

          <div class="col-12">
            <div class="p-4 rounded-4 border bg-body">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="fw-bold">Top Feature Importances</div>
                <a class="btn btn-outline-secondary btn-sm" href="{{ url_for('dashboard') }}">
                  Open Full Dashboard <i class="bi bi-arrow-right ms-1"></i>
                </a>
              </div>
              <div class="text-muted small">Chart is available in Dashboard page.</div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
{% endblock %}
